"use strict";(self.webpackChunkcommerce_extensibility=self.webpackChunkcommerce_extensibility||[]).push([[1527],{84695:function(e,n,a){a.r(n),a.d(n,{_frontmatter:function(){return r},default:function(){return u}});var t=a(87462),o=a(45987),m=(a(35776),a(3905)),i=a(91515);const l=["components"],r={},s=(d="InlineAlert",function(e){return console.warn("Component "+d+" was not imported, exported, or provided by MDXProvider as global scope"),(0,m.mdx)("div",e)});var d;const p={_frontmatter:r},c=i.Z;function u(e){let{components:n}=e,a=(0,o.Z)(e,l);return(0,m.mdx)(c,(0,t.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,m.mdx)("h1",{id:"webhooks-example"},"Webhooks example"),(0,m.mdx)("p",null,"The Adobe Commerce Extensibility Starter Kit supports custom webhooks. This reference implementation demonstrates how to expose an entry point to perform a realtime check of the available stock for Adobe Commerce cart items."),(0,m.mdx)("p",null,"The runtime action included is in the Starter Kit package in the following location:"),(0,m.mdx)("ul",null,(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("inlineCode",{parentName:"li"},"actions/webhook/check-stock/index.js"))),(0,m.mdx)(s,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,m.mdx)("p",null,"You must implement the stock-checking logic on an external service."),(0,m.mdx)("p",null,"This runtime action uses the ",(0,m.mdx)("a",{parentName:"p",href:"../../webhooks/"},"Adobe Commerce webhook module")," to allow intercepting flows in Adobe Commerce."),(0,m.mdx)("h2",{id:"json-payload-example"},"JSON payload example"),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "cart_id": "cart id",\n    "items": [\n      {\n        "item_id": 1,\n        "sku": "Product SKU",\n        "qty": "Cart item qty"\n      }\n    ]\n  }\n}\n')),(0,m.mdx)("h2",{id:"validation"},"Validation"),(0,m.mdx)("p",null,"The following parameters are required:"),(0,m.mdx)("ul",null,(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("inlineCode",{parentName:"li"},"data")),(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("inlineCode",{parentName:"li"},"data.cart_id")),(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("inlineCode",{parentName:"li"},"data.items"))),(0,m.mdx)("p",null,"Sample validation logic is provided in the following location in the Starter Kit package."),(0,m.mdx)("ul",null,(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("inlineCode",{parentName:"li"},"webhook\\check-stock\\validator.js"))),(0,m.mdx)("p",null,"You can modify this file to add more validations to the ",(0,m.mdx)("inlineCode",{parentName:"p"},"validateData")," method, if necessary."),(0,m.mdx)("h2",{id:"check-available-stock"},"Check available stock"),(0,m.mdx)("p",null,"This runtime example uses the ",(0,m.mdx)("inlineCode",{parentName:"p"},"checkAvailableStock()")," method in the ",(0,m.mdx)("inlineCode",{parentName:"p"},"webhook\\check-stock\\stock.js")," file. You must implement this logic to check stock availability for the items received in ",(0,m.mdx)("inlineCode",{parentName:"p"},"params"),"."),(0,m.mdx)("p",null,"You will receive one of the following responses:"),(0,m.mdx)("p",null,(0,m.mdx)("strong",{parentName:"p"},"Items stock available:")),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-javascript"},"return {\n  success: false\n}\n")),(0,m.mdx)("p",null,(0,m.mdx)("strong",{parentName:"p"},"Items stock not available:")),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-javascript"},"return {\n  success: false,\n  message: '<Your custom error message.>'\n}\n")),(0,m.mdx)("h2",{id:"modify-env-parameters"},"Modify ",(0,m.mdx)("inlineCode",{parentName:"h2"},".env")," parameters"),(0,m.mdx)("p",null,"You can access any environment parameters from ",(0,m.mdx)("inlineCode",{parentName:"p"},"params"),". Add any required parameters to the ",(0,m.mdx)("inlineCode",{parentName:"p"},"actions/webhook/check-stock/actions.config.yaml")," under ",(0,m.mdx)("inlineCode",{parentName:"p"},"check-stock -> inputs"),":"),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-yaml"},"check-stock:\n  function: check-stock/index.js\n  web: 'yes'\n  runtime: nodejs:16\n  inputs:\n    LOG_LEVEL: debug\n    \n    HERE_YOUR_PARAM: $YOUR_CUSTOM_PARAMETER\n    \n  annotations:\n    require-adobe-auth: false\n    final: true\n")),(0,m.mdx)("h2",{id:"responses"},"Responses"),(0,m.mdx)("p",null,"Error response:"),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-javascript"},"return {   \n  statusCode: 200,\n  body: {\n    op: 'exception',\n    message: 'Error message'\n  }\n}\n")),(0,m.mdx)("p",null,"Success response:"),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-javascript"},"return {\n  statusCode: 200,\n  body: {\n    op: 'success'\n  }\n}\n")),(0,m.mdx)(s,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,m.mdx)("p",null,"These responses are adapted from the ",(0,m.mdx)("a",{parentName:"p",href:"../../webhooks/responses.md#responses"},"Commerce webhook responses"),". You can modify the response implementation in the code as needed."))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-app-development-starter-kit-hooks-md-2b7ba9601a830915c575.js.map