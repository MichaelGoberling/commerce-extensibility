"use strict";(self.webpackChunkcommerce_extensibility=self.webpackChunkcommerce_extensibility||[]).push([[3913],{17332:function(e,o,t){t.r(o),t.d(o,{_frontmatter:function(){return i},default:function(){return l}});var n=t(87462),a=t(63366),r=(t(15007),t(64983)),d=t(91515),m=["components"],i={},c={_frontmatter:i},s=d.Z;function l(e){var o=e.components,t=(0,a.Z)(e,m);return(0,r.mdx)(s,(0,n.Z)({},c,t,{components:o,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"testing-webhooks"},"Testing Webhooks"),(0,r.mdx)("p",null,"Use the ",(0,r.mdx)("a",{parentName:"p",href:"commands.md#emulate-webhook-execution"},(0,r.mdx)("inlineCode",{parentName:"a"},"webhooks:dev:run <webhook-name> <webhook-arguments-payload>"))," command in development mode to test your webhooks locally. It emulates the execution of your registered webhook, which contains a custom payload, without requiring changes to the Commerce application. Run this command after setting the initial webhook payload in a ",(0,r.mdx)("inlineCode",{parentName:"p"},"webhooks.xml")," file. Then run the command again any time you make subsequent modifications to the payload until you can confirm that the payload works as expected."),(0,r.mdx)("p",null,"In this example, the ",(0,r.mdx)("inlineCode",{parentName:"p"},"webhooks.xml")," file registered the following webhook:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-xml"},'    <method name="observer.checkout_cart_product_add_before" type="before">\n        <hooks>\n            <batch>\n                <hook name="validate_stock" url="{env:APP_BUILDER_PROJECT_URL}/product-validate-stock" timeout="2000" softTimeout="200" fallbackErrorMessage="The product stock validation failed">\n                    <fields>\n                        <field name=\'product.name\' source=\'data.product.name\' />\n                        <field name=\'product.sku\' source=\'data.product.sku\' />\n                    </fields>\n                </hook>\n            </batch>\n        </hooks>\n    </method>\n')),(0,r.mdx)("p",null,"Instead of manually adding a product to the cart from the storefront, you can run the following command, which specifies a custom payload:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},'bin/magento webhooks:dev:run observer.checkout_cart_product_add_before:before \'{"data":{"product":{"sku":"simple-product","name":"Simple Product"}}}\'\n')),(0,r.mdx)("p",null,"The emulated webhook endpoint receives the following payload, according to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"fields")," configured for the webhook:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{"product":{"name":"Simple Product","sku":"simple-product"}}\n')),(0,r.mdx)("p",null,"If an error occurs, or if an exception is thrown, a message similar to the following is displayed:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-terminal"},'Failed to process webhook "observer.checkout_cart_product_add_before". Or webhook endpoint returned exception operation. Error: Webhook Response: The product is out of stock\nCheck logs for more information.\n')))}l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-webhooks-testing-md-ab7d9a216d3292a885e8.js.map